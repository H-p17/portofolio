<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin Dashboard</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/admin.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="dashboard-body">

<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="brand"><span class="logo-dot"></span><span class="brand-text">Admin</span></div>
  </div>
  <ul class="sidebar-menu">
    <li><a class="active" href="#">Dashboard</a></li>
    <li><a href="#">Projects</a></li>
    <li><a href="#">Users</a></li>
    <li><a href="#" id="openSettings">Settings</a></li>
  </ul>
  <div class="spacer"></div>
  <div class="sidebar-footer">
    <button id="toggle-theme" class="btn btn-ghost round">Toggle Theme</button>
    <button id="logoutBtn" class="btn btn-danger mt-2 w-100">Logout</button>
  </div>
</aside>

<main class="main-content" id="mainContent">
  <nav class="topbar">
    <h1 class="page-title">Project Management</h1>
    <div class="topbar-actions">
      <button id="openAdd" class="btn btn-add">+ Add Project</button>
    </div>
  </nav>

  <section class="row stats-row">
    <div class="col-md-4"><div class="stats-card"><div class="stats-icon">üìÅ</div>
      <div><div class="stats-number" id="total-projects">0</div><div class="stats-label">Total Projects</div></div></div></div>
    <div class="col-md-4"><div class="stats-card"><div class="stats-icon">üîó</div>
      <div><div class="stats-number" id="projects-with-links">0</div><div class="stats-label">Projects with Links</div></div></div></div>
    <div class="col-md-4"><div class="stats-card"><div class="stats-icon">üñºÔ∏è</div>
      <div><div class="stats-number" id="projects-with-images">0</div><div class="stats-label">Projects with Images</div></div></div></div>
  </section>

  <section class="projects-shell">
    <h2 class="section-title">Your Projects</h2>
    <div id="projects-container"></div>
  </section>
</main>

<!-- Project Modal -->
<div class="modal fade" id="projectModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content modal-solid">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTitle">Add Project</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="projectForm">
          <input type="hidden" id="projectId"/>
          <label>Title</label>
          <input id="projectTitle" class="form-control input-dark" placeholder="Project title" required>
          <label>Description</label>
          <textarea id="projectDescription" class="form-control input-dark" rows="4" placeholder="Short description" required></textarea>
          <label>Link (optional)</label>
          <input id="projectLink" class="form-control input-dark" placeholder="https://example.com">
          <label>Image</label>
          <input id="projectImage" type="file" class="form-control input-dark">
          <div id="filePreview" class="file-preview mt-2"></div>
          <div class="mt-3 d-flex gap-2 justify-content-end">
            <button type="button" class="btn btn-ghost" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-add">Save Project</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div class="modal fade" id="settingsModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content modal-solid">
      <div class="modal-header">
        <h5 class="modal-title">Admin Settings</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="settingsForm">
          <label>Change Password</label>
          <input type="password" id="newPassword" class="form-control input-dark" placeholder="New password" required>
          <div class="mt-3 d-flex gap-2 justify-content-end">
            <button type="button" class="btn btn-ghost" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-add">Save Password</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/main.js"></script>
<script>
  // ===== ADMIN ACCESS CHECK =====
  if(sessionStorage.getItem('adminLoggedIn') !== 'true'){
    window.location.href = 'index.html';
  }

  // ===== LOGOUT =====
  const logoutBtn = document.getElementById('logoutBtn');
  logoutBtn.addEventListener('click', function(){
    sessionStorage.removeItem('adminLoggedIn');
    window.location.href = 'index.html';
  });

  // ===== OPEN SETTINGS =====
  const openSettingsBtn = document.getElementById('openSettings');
  const settingsModalEl = document.getElementById('settingsModal');
  const settingsModal = new bootstrap.Modal(settingsModalEl);
  openSettingsBtn.addEventListener('click', () => settingsModal.show());

  // ===== CHANGE PASSWORD =====
  document.getElementById('settingsForm').addEventListener('submit', function(e){
    e.preventDefault();
    const newPassword = document.getElementById('newPassword').value.trim();
    if(newPassword.length < 4){
      alert("Password must be at least 4 characters.");
      return;
    }
    localStorage.setItem('adminPassword', newPassword);
    alert("Password updated successfully!");
    settingsModal.hide();
  });

  // Optional: override hardcoded password from session
  const savedPass = localStorage.getItem('adminPassword');
  if(savedPass){
    window.ADMIN_PASSWORD = savedPass;
  }
</script>
</body>
</html>
